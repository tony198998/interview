Redis的同步机制

Redis的复制功能分为同步(sync )和命令传播( command propagate )两个操作:

1、同步操作用于将从服务器的数据库状态更新至主服务器当前所处的数据库状态。
2、命令传播操作则用于在主服务器的数据库状态被修改,导致主从服务器的数据库状态出现不一致时,
让主从服务器的数据库重新回到一致状态

从服务器向主服务器发送一个sync命令，主服务器从开始接收客户端的bgsave命令开始，生成一个RDB文件或者Aof文件，
从服务器接收到该文件时，就将该文件中的写命令写到自己的服务器

redis提供两种方式进行持久化，
一种是RDB持久化（原理是将Reids在内存中的数据库记录定时dump到磁盘上的RDB持久化），
另外一种是AOF持久化（原理是将Reids的操作日志以追加的方式写入文件）。那么这两种持久化方式有什么区别呢，

RDB持久化是指在指定的时间间隔内将内存中的数据集快照写入磁盘，实际操作过程是fork一个子进程，
先将数据集写入临时文件，写入成功后，再替换之前的文件，用二进制压缩存储。

AOF持久化以日志的形式记录服务器所处理的每一个写、删除操作，查询操作不会记录，
以文本的方式记录，可以打开文件看到详细的操作记录。

1、set a 12
   decr a  :后是11
   incr a : 后加1是12